<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ player_name }} ‚Äì Profile</title>
    <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body{font-family:'Inter',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;background-attachment:fixed}
        .card{background:rgba(255,255,255,0.95);border-radius:1rem;box-shadow:0 10px 15px -3px rgba(0,0,0,0.1),0 4px 6px -4px rgba(0,0,0,0.1);backdrop-filter:blur(6px)}
        h1{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-shadow:0 2px 4px rgba(0,0,0,0.1)}
    </style>
</head>
<body class="text-gray-800">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold mb-6 text-center">üèÄ {{ player_name }} ‚Äì Player Profile</h1>

        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="card p-6">
                <h2 class="text-xl font-semibold mb-4">Team Performance WITH {{ player_name }}</h2>
                <p class="mb-2"><span class="font-medium">Wins / Losses:</span> {{ perf_with.wins }}-{{ perf_with.losses }}</p>
                <p class="mb-2"><span class="font-medium">Avg Team Pts:</span> {{ perf_with.avg_for }}</p>
                <p><span class="font-medium">Avg Opp Pts:</span> {{ perf_with.avg_against }}</p>
            </div>
            <div class="card p-6">
                <h2 class="text-xl font-semibold mb-4">Team Performance WITHOUT {{ player_name }}</h2>
                <p class="mb-2"><span class="font-medium">Wins / Losses:</span> {{ perf_without.wins }}-{{ perf_without.losses }}</p>
                <p class="mb-2"><span class="font-medium">Avg Team Pts:</span> {{ perf_without.avg_for }}</p>
                <p><span class="font-medium">Avg Opp Pts:</span> {{ perf_without.avg_against }}</p>
            </div>
        </div>

        <!-- Average Points Baseline -->
        <div class="card p-6 mb-8 text-center">
            <h2 class="text-xl font-semibold mb-2">Average Points Per Game</h2>
            <p class="text-4xl font-bold text-indigo-600">{{ avg_pts }}</p>
            <p class="text-sm text-gray-500">Games deviating by &gt; {{ threshold }} pts are highlighted below</p>
        </div>

        <!-- Game Log -->
        <div class="card p-6 mb-8 overflow-x-auto">
            <h2 class="text-xl font-semibold mb-4">Complete Game Log</h2>
            <table class="min-w-full text-sm">
                <thead class="bg-gray-100">
                    <tr>
                        <th class="px-3 py-2 text-left">Date</th>
                        <th class="px-3 py-2 text-left">Team</th>
                        <th class="px-3 py-2 text-left">Opponent</th>
                        <th class="px-3 py-2 text-right">MIN</th>
                        <th class="px-3 py-2 text-right">PTS</th>
                        <th class="px-3 py-2 text-right">REB</th>
                        <th class="px-3 py-2 text-right">AST</th>
                    </tr>
                </thead>
                <tbody>
                    {% for g in player_games %}
                    <tr class="border-b last:border-0">
                        <td class="px-3 py-2">{{ g.date }}</td>
                        <td class="px-3 py-2">{{ g.team }}</td>
                        <td class="px-3 py-2">{{ g.opponent }}</td>
                        <td class="px-3 py-2 text-right">{{ g.minutes }}</td>
                        <td class="px-3 py-2 text-right">{{ g.points }}</td>
                        <td class="px-3 py-2 text-right">{{ g.rebounds }}</td>
                        <td class="px-3 py-2 text-right">{{ g.assists }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Performance Breakdown Lists -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="card p-6">
                <h2 class="text-xl font-semibold mb-4">Games WITH {{ player_name }}</h2>
                <ul class="space-y-2 text-sm">
                    {% for g in perf_with.games %}
                    <li class="bg-gray-50 p-3 rounded">
                        <span class="font-medium">{{ g.date }}</span> ‚Äì vs {{ g.opponent }} : <span class="font-semibold {{ 'text-green-600' if g.result == 'W' else 'text-red-600' }}">{{ g.result }}</span> ({{ g.team_pts }}-{{ g.opp_pts }})
                    </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="card p-6">
                <h2 class="text-xl font-semibold mb-4">Games WITHOUT {{ player_name }}</h2>
                <ul class="space-y-2 text-sm">
                    {% for g in perf_without.games %}
                    <li class="bg-gray-50 p-3 rounded">
                        <span class="font-medium">{{ g.date }}</span> ‚Äì vs {{ g.opponent }} : <span class="font-semibold {{ 'text-green-600' if g.result == 'W' else 'text-red-600' }}">{{ g.result }}</span> ({{ g.team_pts }}-{{ g.opp_pts }})
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <!-- Performance Deviation Lists -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
            <!-- Under Performance -->
            <div class="card p-6">
                <h2 class="text-xl font-semibold mb-4 text-red-600">Under-performance Games (below avg)</h2>
                {% if under_perf %}
                <ul class="space-y-3 text-sm">
                    {% for g in under_perf %}
                    <li class="bg-gray-50 p-3 rounded">
                        <div class="flex justify-between">
                            <span class="font-medium">{{ g.date }} vs {{ g.opponent }}</span>
                            <span class="text-red-600 font-semibold">{{ g.points }} pts ({{ g.diff }})</span>
                        </div>
                        <p class="text-xs text-gray-600">Team {{ g.team_pts }}-{{ g.opp_pts }} ({{ g.result }})
                        {% if g.missing_core %}<br>Missing: {{ g.missing_core | join(', ') }}{% endif %}</p>
                    </li>
                    {% endfor %}
                </ul>
                {% else %}<p class="text-gray-500">No significant under-performance games.</p>{% endif %}
            </div>
            <!-- Over Performance -->
            <div class="card p-6">
                <h2 class="text-xl font-semibold mb-4 text-green-600">Over-performance Games (above avg)</h2>
                {% if over_perf %}
                <ul class="space-y-3 text-sm">
                    {% for g in over_perf %}
                    <li class="bg-gray-50 p-3 rounded">
                        <div class="flex justify-between">
                            <span class="font-medium">{{ g.date }} vs {{ g.opponent }}</span>
                            <span class="text-green-600 font-semibold">{{ g.points }} pts (+{{ g.diff }})</span>
                        </div>
                        <p class="text-xs text-gray-600">Team {{ g.team_pts }}-{{ g.opp_pts }} ({{ g.result }})
                        {% if g.missing_core %}<br>Team core present; notable context: missing {{ g.missing_core | join(', ') }}{% endif %}</p>
                    </li>
                    {% endfor %}
                </ul>
                {% else %}<p class="text-gray-500">No significant over-performance games.</p>{% endif %}
            </div>
        </div>
    </div>
    
</body>
</html>
